<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LinkStorage</title>
  <link rel="stylesheet" href="css/myPatternLock.css">
  <style>
*{
}
.container {
  margin: 0 auto;
  position: relative;
}
#mpl {
  margin: auto;
  margin-top: 400px;
  display: grid;
  background-color: black;
}
.outcircle {
  border: 7px solid white;
  border-radius: 50%;
  display: flex;
}
.incircle {
  margin: auto;
  background-color: white;
  width: 15px;
  height: 15px;
  border-radius: 50%;
}
#myCanvas {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  margin: auto;
}
  </style>
</head>
<body>

  <div class="container">
    <div id="mpl"></div>
    <canvas id="myCanvas" class="canvas"></canvas>  
  </div>
  

  <!--firebase7/8/9 CDN (now 8)-->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="js/firebase_config.js"></script>
  <!--icon-->
  <script src="https://kit.fontawesome.com/490800a206.js" crossorigin="anonymous"></script>
  <!--jQuery cdn https://releases.jquery.com/ --> 
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!--sweetalert cdn https://sweetalert.js.org/guides/-->
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

  <script> // src="js/myPatternLock.js"

    var mpl_row = 3;
    var mpl_col = 4;
    draw_mpl(mpl_row, mpl_col, 60, 100, 100);

    function draw_mpl(row, col, gap, rad, pad) {
      var w = rad*col+gap*(col-1);
      var h = rad*row+gap*(row-1);
      $("#mpl").empty();
      $("#mpl").css({
        "width": `${w}`,
        "height": `${h}`,
        "padding": `${pad}px`,
        "grid-template-columns": `repeat(${col}, 1fr)`,
        "grid-template-rolumns": `repeat(${row}, 1fr)`,
        "gap": `${gap}px`
      });
      for (var i=0; i<row*col; i++) {
        $("#mpl").append(`<div id='outcircle${i}' class='outcircle'><div id='incircle${i}' class='incircle'></div></div>`)
      }
      $("#myCanvas").attr("width", w+2*pad).attr("height", h+2*pad);
    }

    const canvas = document.getElementById("myCanvas");
    const ctx = canvas.getContext("2d");
    var painting = false;

    ctx.strokeStyle = "white";
    ctx.lineWidth = 10;
    ctx.lineCap = "round";
    var dragging = false;
    var startpointX;
    var startpointY;

    function onMouseUp(event) {
      stopPainting();
    }
    function onMouseDown(event) {
      dragging = true;
      startpointX = event.offsetX;
      startpointY = event.offsetY;
    }
    function onMouseMove(event) {
      const x = event.offsetX;
      const y = event.offsetY;
      
      if (dragging) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.moveTo(startpointX, startpointY);
        ctx.lineTo(x, y);
        ctx.stroke();
      }
      
    }
    function stopPainting(event) {
      dragging = false;
    }
    function getDots(row, col, gap, rad, pad) {
      arr = [];
      for (var i=0; i < col; i++) {
        for (var j=0; j < row; j++) {
          var tmp = [];
          arr.append(tmp); 
        }
      }
    }

    if (canvas) {
      // velog.io/@mokyoungg/JS-JS에서-Canvas-사용하기마우스로-그리기
      canvas.addEventListener("mousemove", onMouseMove);
      canvas.addEventListener("mousedown", onMouseDown);
      canvas.addEventListener("mouseup", onMouseUp);
      canvas.addEventListener("mouseleave", stopPainting);
    }
    


  </script>

</body>
</html>